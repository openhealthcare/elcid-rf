<div class="panel panel-default">
  <div class="panel-heading">
    <h3><i class="fa fa-crosshairs"></i>
      Cultures, PCRs & IGRAs
    </h3>
  </div>
  <div ng-show="tb_tests.culture_count || tb_tests.pcr_count || tb_tests.igra_count" patient-api target='tb_tests' endpoint='tb_tests' class="panel-footer">
    <div ng-class="{'content-offset-below-20': tb_tests.igra.length || tb_tests.pcrs.length}" ng-if="tb_tests.cultures.length">
      <div class="row content-offset-below-5">
        <div class="col-md-6">
          <strong>Cultures</strong>
        </div>
        <div class="col-md-6 text-right">
          Latest
          <span ng-show="tb_tests.culture_count > 5">5</span>
          <span ng-hide="tb_tests.culture_count > 5">[[ tb_tests.culture_count ]]</span>
          of [[ tb_tests.culture_count ]]
        </div>
      </div>
      <div ng-repeat="culture in tb_tests.cultures">
        <div ng-class="{'text-muted': !culture.positive}">
          [[ culture.title ]]
          <div class="left-offset-10" ng-repeat="(obs_name, display_lines) in culture.by_obs_display track by $index">
            <div ng-class="{'left-offset-10': !$first}" ng-repeat="display in display_lines track by $index">
              [[ display ]]
            </div>
          </div>

          <div ng-class="{'left-offset-20': !$first && culture_line.indexOf('AFB Smear') !== 0 && culture_line.indexOf('TB: Culture Result') !== 0 && culture_line.indexOf('TB Ref. Lab. Culture result') !== 0}">
          [[ culture_line ]]
          </div>
        </div>
      </div>
    </div>
    <div ng-class="{'content-offset-below-20': tb_tests.igra.length}" ng-if="tb_tests.pcrs.length">
      <div class="row content-offset-below-5">
        <div class="col-md-6">
          <strong>PCRs</strong>
        </div>
        <div class="col-md-6 text-right">
          Latest
          <span ng-show="tb_tests.pcr_count > 5">5</span>
          <span ng-hide="tb_tests.pcr_count > 5">[[ tb_tests.pcr_count ]]</span>
          of [[ tb_tests.pcr_count ]]
        </div>
      </div>
      <div ng-repeat="pcr in tb_tests.pcrs">
        <div ng-class="{'text-muted': !pcr.positive, 'left-offset-10': !$first}" ng-repeat="pcr_line in pcr.text track by $index">
          [[ pcr_line ]]
        </div>
      </div>
    </div>
    <div ng-if="tb_tests.igra.length">
      <div class="row content-offset-below-5">
        <div class="col-md-6">
          <strong>IGRA</strong>
        </div>
        <div class="col-md-6 text-right">
          Latest
          <span ng-show="tb_tests.igra_count > 5">5</span>
          <span ng-hide="tb_tests.igra_count > 5">[[ tb_tests.igra_count ]]</span>
          of [[ tb_tests.igra_count ]]
        </div>
      </div>
      <div ng-repeat="igra in tb_tests.igra">
        <div ng-class="{'text-muted': !igra.positive, 'left-offset-10': !$first}" ng-repeat="igra_line in igra.text">
          [[ igra_line ]]
        </div>
      </div>
    </div>
  </div>
</div>
