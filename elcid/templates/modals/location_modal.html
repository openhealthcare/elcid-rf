{% extends 'base_templates/modal_base.html' %}
{% load forms %}
{% block icon_name %}fa fa-map-marker{% endblock %}
{% block modal_body %}
  <form class="form-horizontal">
    <div class="form-group">
      <label class="control-label col-sm-3">Category</label>
      <div class="col-sm-8" ng-show="editing.category == 'Discharged'">
        <p>
          [[ editing.category ]] &nbsp;
          <button class="btn" ng-click="undischarge()">Undischarge</button>
        </p>
      </div>
      <div class="col-sm-8" ng-hide="editing.category && editing.category == 'Discharged' || episode_category_list.indexOf(editing.category) == -1">
        <select class="form-control" ng-model="editing.category" autofocus>
          <option value="">---------</option>
          <option ng-repeat="category in episode_category_list">[[category]]</option>
        </select>
      </div>
      <div class="col-sm-8" ng-show="episode_category_list.indexOf(editing.category) == -1 && editing.category != 'Discharged'">
        <p>[[ episode.category ]]</p>
      </div>
    </div>

    <div class="form-group" ng-hide="episode.category == 'OPAT'">
      <label class="control-label col-sm-3">Hospital</label>
      <div class="col-sm-8">
        <select class="form-control" ng-model="editing.hospital">
          <option value="">---------</option>
          <option ng-repeat="hospital in hospital_list">[[hospital]]</option>
          <option>Other</option>
        </select>
      </div>
    </div>

    {% select model="editing.hospital" label="Hospital - Other" hide="episode.category == 'OPAT'" show="hospital_list.indexOf(editing.hospital) == -1" %}
    {% select model="editing.ward" label="Ward" lookuplist="ward_list" hide="episode.category == 'OPAT'" %}
    {% input model="editing.bed" label="Bed" hide="episode.category == 'OPAT'" %}
    {% datepicker model="episode.date_of_admission" label="Date of admission" %}

    <!-- OPAT Only fields -->
    {% datepicker label="Date of referral to OPAT" model="editing.opat_referral" show="episode.category == 'OPAT'"%}
    {% input label="Referring consultant" model="editing.opat_referral_consultant" show="episode.category == 'OPAT'" %}
    {% select label="Referring team" model="editing.opat_referral_team" lookuplist="speciality_list" show="episode.category == 'OPAT'" %}
    {% textarea label="Referring team address" model="editing.opat_referral_team_address" show="episode.category == 'OPAT'" %}

  </form>
{% endblock %}
